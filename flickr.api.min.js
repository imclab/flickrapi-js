var hexcase=0,b64pad="",chrsz=8;function hex_md5(d){return binl2hex(core_md5(str2binl(d),d.length*chrsz))}function b64_md5(d){return binl2b64(core_md5(str2binl(d),d.length*chrsz))}function str_md5(d){return binl2str(core_md5(str2binl(d),d.length*chrsz))}function hex_hmac_md5(d,g){return binl2hex(core_hmac_md5(d,g))}function b64_hmac_md5(d,g){return binl2b64(core_hmac_md5(d,g))}function str_hmac_md5(d,g){return binl2str(core_hmac_md5(d,g))}
function md5_vm_test(){return hex_md5("abc")=="900150983cd24fb0d6963f7d28e17f72"}
function core_md5(d,g){d[g>>5]|=128<<g%32;d[(g+64>>>9<<4)+14]=g;for(var b=1732584193,a=-271733879,c=-1732584194,e=271733878,f=0;f<d.length;f+=16){var h=b,i=a,j=c,k=e;b=md5_ff(b,a,c,e,d[f+0],7,-680876936);e=md5_ff(e,b,a,c,d[f+1],12,-389564586);c=md5_ff(c,e,b,a,d[f+2],17,606105819);a=md5_ff(a,c,e,b,d[f+3],22,-1044525330);b=md5_ff(b,a,c,e,d[f+4],7,-176418897);e=md5_ff(e,b,a,c,d[f+5],12,1200080426);c=md5_ff(c,e,b,a,d[f+6],17,-1473231341);a=md5_ff(a,c,e,b,d[f+7],22,-45705983);b=md5_ff(b,a,c,e,d[f+8],7,
1770035416);e=md5_ff(e,b,a,c,d[f+9],12,-1958414417);c=md5_ff(c,e,b,a,d[f+10],17,-42063);a=md5_ff(a,c,e,b,d[f+11],22,-1990404162);b=md5_ff(b,a,c,e,d[f+12],7,1804603682);e=md5_ff(e,b,a,c,d[f+13],12,-40341101);c=md5_ff(c,e,b,a,d[f+14],17,-1502002290);a=md5_ff(a,c,e,b,d[f+15],22,1236535329);b=md5_gg(b,a,c,e,d[f+1],5,-165796510);e=md5_gg(e,b,a,c,d[f+6],9,-1069501632);c=md5_gg(c,e,b,a,d[f+11],14,643717713);a=md5_gg(a,c,e,b,d[f+0],20,-373897302);b=md5_gg(b,a,c,e,d[f+5],5,-701558691);e=md5_gg(e,b,a,c,d[f+
10],9,38016083);c=md5_gg(c,e,b,a,d[f+15],14,-660478335);a=md5_gg(a,c,e,b,d[f+4],20,-405537848);b=md5_gg(b,a,c,e,d[f+9],5,568446438);e=md5_gg(e,b,a,c,d[f+14],9,-1019803690);c=md5_gg(c,e,b,a,d[f+3],14,-187363961);a=md5_gg(a,c,e,b,d[f+8],20,1163531501);b=md5_gg(b,a,c,e,d[f+13],5,-1444681467);e=md5_gg(e,b,a,c,d[f+2],9,-51403784);c=md5_gg(c,e,b,a,d[f+7],14,1735328473);a=md5_gg(a,c,e,b,d[f+12],20,-1926607734);b=md5_hh(b,a,c,e,d[f+5],4,-378558);e=md5_hh(e,b,a,c,d[f+8],11,-2022574463);c=md5_hh(c,e,b,a,d[f+
11],16,1839030562);a=md5_hh(a,c,e,b,d[f+14],23,-35309556);b=md5_hh(b,a,c,e,d[f+1],4,-1530992060);e=md5_hh(e,b,a,c,d[f+4],11,1272893353);c=md5_hh(c,e,b,a,d[f+7],16,-155497632);a=md5_hh(a,c,e,b,d[f+10],23,-1094730640);b=md5_hh(b,a,c,e,d[f+13],4,681279174);e=md5_hh(e,b,a,c,d[f+0],11,-358537222);c=md5_hh(c,e,b,a,d[f+3],16,-722521979);a=md5_hh(a,c,e,b,d[f+6],23,76029189);b=md5_hh(b,a,c,e,d[f+9],4,-640364487);e=md5_hh(e,b,a,c,d[f+12],11,-421815835);c=md5_hh(c,e,b,a,d[f+15],16,530742520);a=md5_hh(a,c,e,
b,d[f+2],23,-995338651);b=md5_ii(b,a,c,e,d[f+0],6,-198630844);e=md5_ii(e,b,a,c,d[f+7],10,1126891415);c=md5_ii(c,e,b,a,d[f+14],15,-1416354905);a=md5_ii(a,c,e,b,d[f+5],21,-57434055);b=md5_ii(b,a,c,e,d[f+12],6,1700485571);e=md5_ii(e,b,a,c,d[f+3],10,-1894986606);c=md5_ii(c,e,b,a,d[f+10],15,-1051523);a=md5_ii(a,c,e,b,d[f+1],21,-2054922799);b=md5_ii(b,a,c,e,d[f+8],6,1873313359);e=md5_ii(e,b,a,c,d[f+15],10,-30611744);c=md5_ii(c,e,b,a,d[f+6],15,-1560198380);a=md5_ii(a,c,e,b,d[f+13],21,1309151649);b=md5_ii(b,
a,c,e,d[f+4],6,-145523070);e=md5_ii(e,b,a,c,d[f+11],10,-1120210379);c=md5_ii(c,e,b,a,d[f+2],15,718787259);a=md5_ii(a,c,e,b,d[f+9],21,-343485551);b=safe_add(b,h);a=safe_add(a,i);c=safe_add(c,j);e=safe_add(e,k)}return Array(b,a,c,e)}function md5_cmn(d,g,b,a,c,e){return safe_add(bit_rol(safe_add(safe_add(g,d),safe_add(a,e)),c),b)}function md5_ff(d,g,b,a,c,e,f){return md5_cmn(g&b|~g&a,d,g,c,e,f)}function md5_gg(d,g,b,a,c,e,f){return md5_cmn(g&a|b&~a,d,g,c,e,f)}
function md5_hh(d,g,b,a,c,e,f){return md5_cmn(g^b^a,d,g,c,e,f)}function md5_ii(d,g,b,a,c,e,f){return md5_cmn(b^(g|~a),d,g,c,e,f)}function core_hmac_md5(d,g){var b=str2binl(d);if(b.length>16)b=core_md5(b,d.length*chrsz);for(var a=Array(16),c=Array(16),e=0;e<16;e++){a[e]=b[e]^909522486;c[e]=b[e]^1549556828}b=core_md5(a.concat(str2binl(g)),512+g.length*chrsz);return core_md5(c.concat(b),640)}function safe_add(d,g){var b=(d&65535)+(g&65535);return(d>>16)+(g>>16)+(b>>16)<<16|b&65535}
function bit_rol(d,g){return d<<g|d>>>32-g}function str2binl(d){for(var g=[],b=(1<<chrsz)-1,a=0;a<d.length*chrsz;a+=chrsz)g[a>>5]|=(d.charCodeAt(a/chrsz)&b)<<a%32;return g}function binl2str(d){for(var g="",b=(1<<chrsz)-1,a=0;a<d.length*32;a+=chrsz)g+=String.fromCharCode(d[a>>5]>>>a%32&b);return g}function binl2hex(d){for(var g=hexcase?"0123456789ABCDEF":"0123456789abcdef",b="",a=0;a<d.length*4;a++)b+=g.charAt(d[a>>2]>>a%4*8+4&15)+g.charAt(d[a>>2]>>a%4*8&15);return b}
function binl2b64(d){for(var g="",b=0;b<d.length*4;b+=3)for(var a=(d[b>>2]>>8*(b%4)&255)<<16|(d[b+1>>2]>>8*((b+1)%4)&255)<<8|d[b+2>>2]>>8*((b+2)%4)&255,c=0;c<4;c++)g+=b*8+c*6>d.length*32?b64pad:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>6*(3-c)&63);return g}var from={yahoo:{flickr:{}}};if(flickr===undefined)var flickr=from.yahoo.flickr;
from.yahoo.flickr.api=function(d,g){d=d;var b={};b.api_call=function(a,c){c.api_key=key;c.method=a;c.format="json";c.nojsoncallback=1;if(c.auth_token){api_sig=this.sign_args(c);c.api_sig=api_sig}};b.upload=function(a,c){c.api_key=d;api_sig=this.sign_args(c);c.api_sig=api_sig;c.photo=a;this._upload(c)};b.sign_args=function(a){var c=[];for(var e in a)c[c.length]=[e,a[e]];c.sort(function(f,h){if(f[0]==h[0])return 0;if(f[0]<h[0])return-1;return 1});a=g;for(e=0;e<c.length;e++){a+=c[e][0];a+=c[e][1]}return hex_md5(a)};
b._upload=function(a){var c=this._generate_multipart_boundary(),e=new XMLHttpRequest;e.open("POST","http://api.flickr.com/services/upload/",true);e.onreadystatechange=function(){};e.setRequestHeader("Content-Type","multipart/form-data; boundary="+c);e.sendAsBinary(this._build_multipart_message(a,c))};b._generate_multipart_boundary=function(){return"---------------------------"+(new Date).getTime()};b._build_multipart_message=function(a,c){var e=[];for(var f in a){var h="";if(f=="photo"){h+="Content-Disposition: form-data; ";
h+='name="photo"; ';h+='filename="photo"\r\n';h+="Content-Type: application/octet-stream\r\n\r\n"}else{h+="Content-Disposition: form-data; ";h+='name="'+f+'"\r\n\r\n'}h+=a[f]+"\r\n";e.push(h)}f="--"+c+"\r\n";f+=e.join("--"+c+"\r\n");f+="--"+c+"--\r\n";return f};return b};if(XMLHttpRequest.prototype.sendAsBinary==undefined)XMLHttpRequest.prototype.sendAsBinary=function(d){d=Array.prototype.map.call(d,function(g){return g.charCodeAt(0)&255});this.send((new Uint8Array(d)).buffer)};
